import{o as n,c as a,b as s}from"./app.157864df.js";const t='{"title":"Vue组件为什么只能有一个根元素?","description":"","frontmatter":{},"headers":[{"level":2,"title":"Vue组件为什么只能有一个根元素?","slug":"vue组件为什么只能有一个根元素"},{"level":3,"title":"体验一下","slug":"体验一下"},{"level":3,"title":"回答思路","slug":"回答思路"},{"level":3,"title":"范例","slug":"范例"},{"level":3,"title":"知其所以然","slug":"知其所以然"}],"relativePath":"frame/vue/26-Vue组件为什么只能有一个根元素.md","lastUpdated":1662433250873}',e={},p=[s('<h2 id="vue组件为什么只能有一个根元素">Vue组件为什么只能有一个根元素?</h2><p>这题现在有些落伍，<code>vue3</code>已经不用一个根了。因此这题目很有说头！</p><hr><h3 id="体验一下">体验一下</h3><p>vue2直接报错，test-v2.html</p><div class="language-bash"><pre><code>new Vue<span class="token punctuation">(</span><span class="token punctuation">{</span>\n  components: <span class="token punctuation">{</span>\n    comp: <span class="token punctuation">{</span>\n      template: <span class="token variable"><span class="token variable">`</span>\n        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>root<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span>/div<span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>root<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>/div<span class="token operator">&gt;</span>\n      <span class="token variable">`</span></span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>.<span class="token variable">$mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://qn.huat.xyz/mac/20220829000844.awebp" alt="img"></p><hr><p>vue3中没有问题，test-v3.html</p><div class="language-php"><pre><code>Vue<span class="token operator">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    comp<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      template<span class="token punctuation">:</span> <span class="token string backtick-quoted-string">`\n        &lt;div&gt;root1&lt;/div&gt;\n        &lt;div&gt;root2&lt;/div&gt;\n      `</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;#app&#39;</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://qn.huat.xyz/mac/20220829000844.awebp" alt="img"></p><hr><h3 id="回答思路">回答思路</h3><ul><li>给一条自己的结论</li><li>解释为什么会这样</li><li><code>vue3</code>解决方法原理</li></ul><hr><h3 id="范例">范例</h3><ul><li><code>vue2</code>中组件确实只能有一个根，但<code>vue3</code>中组件已经可以多根节点了。</li><li>之所以需要这样是因为<code>vdom</code>是一颗单根树形结构，<code>patch</code>方法在遍历的时候从根节点开始遍历，它要求只有一个根节点。组件也会转换为一个<code>vdom</code>，自然应该满足这个要求。</li><li><code>vue3</code>中之所以可以写多个根节点，是因为引入了<code>Fragment</code>的概念，这是一个抽象的节点，如果发现组件是多根的，就创建一个Fragment节点，把多个根节点作为它的children。将来patch的时候，如果发现是一个Fragment节点，则直接遍历children创建或更新。</li></ul><hr><h3 id="知其所以然">知其所以然</h3><ul><li><p>patch方法接收单根vdom：</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fcore%2Fblob%2FHEAD%2Fpackages%2Fruntime-core%2Fsrc%2Frenderer.ts%23L354-L355" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/core/…</a></p><div class="language-rust"><pre><code><span class="token comment">// 直接获取type等，没有考虑数组的可能性</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token keyword">ref</span><span class="token punctuation">,</span> shapeFlag <span class="token punctuation">}</span> <span class="token operator">=</span> n2\n</code></pre></div></li><li><p>patch方法对Fragment的处理：</p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fcore%2Fblob%2FHEAD%2Fpackages%2Fruntime-core%2Fsrc%2Frenderer.ts%23L1091-L1092" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/core/…</a></p><div class="language-scss"><pre><code><span class="token comment">// a fragment can only have array children</span>\n<span class="token comment">// since they are either generated by the compiler, or implicitly created</span>\n<span class="token comment">// from arrays.</span>\n<span class="token function">mountChildren</span><span class="token punctuation">(</span>n2.children <span class="token module-modifier keyword">as</span> VNodeArrayChildren<span class="token punctuation">,</span> container<span class="token punctuation">,</span> ...<span class="token punctuation">)</span>\n</code></pre></div></li></ul>',20)];e.render=function(s,t,e,o,c,l){return n(),a("div",null,p)};export default e;export{t as __pageData};
