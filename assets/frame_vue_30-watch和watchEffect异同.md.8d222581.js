import{_ as n,e as a,o as s,Q as t}from"./plugin-vue_export-helper.8dc630d2.js";const f='{"title":"30-watch\u548CwatchEffect\u5F02\u540C","description":"","frontmatter":{},"headers":[{"level":2,"title":"30-watch\u548CwatchEffect\u5F02\u540C","slug":"_30-watch\u548Cwatcheffect\u5F02\u540C"},{"level":3,"title":"\u4F53\u9A8C","slug":"\u4F53\u9A8C"},{"level":3,"title":"\u601D\u8DEF","slug":"\u601D\u8DEF"},{"level":3,"title":"\u8303\u4F8B","slug":"\u8303\u4F8B"},{"level":3,"title":"\u77E5\u5176\u6240\u4EE5\u7136","slug":"\u77E5\u5176\u6240\u4EE5\u7136"},{"level":2,"title":"","slug":""}],"relativePath":"frame/vue/30-watch\u548CwatchEffect\u5F02\u540C.md","lastUpdated":1676090914508}',e={},o=t(`<h2 id="_30-watch\u548Cwatcheffect\u5F02\u540C">30-watch\u548CwatchEffect\u5F02\u540C</h2><p>\u6211\u4EEC\u7ECF\u5E38\u6027\u9700\u8981\u4FA6\u6D4B\u54CD\u5E94\u5F0F\u6570\u636E\u7684\u53D8\u5316\uFF0Cvue3\u4E2D\u9664\u4E86watch\u4E4B\u5916\u53C8\u51FA\u73B0\u4E86watchEffect\uFF0C\u4E0D\u5C11\u540C\u5B66\u4F1A\u6DF7\u6DC6\u8FD9\u4E24\u4E2Aapi\u3002</p><h3 id="\u4F53\u9A8C">\u4F53\u9A8C</h3><p><code>watchEffect</code>\u7ACB\u5373\u8FD0\u884C\u4E00\u4E2A\u51FD\u6570\uFF0C\u7136\u540E\u88AB\u52A8\u5730\u8FFD\u8E2A\u5B83\u7684\u4F9D\u8D56\uFF0C\u5F53\u8FD9\u4E9B\u4F9D\u8D56\u6539\u53D8\u65F6\u91CD\u65B0\u6267\u884C\u8BE5\u51FD\u6570\u3002</p><blockquote><p>Runs a function immediately while reactively tracking its dependencies and re-runs it whenever the dependencies are changed.</p></blockquote><div class="language-js"><pre><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// -&gt; logs 0</span>

count<span class="token punctuation">.</span>value<span class="token operator">++</span>
<span class="token comment">// -&gt; logs 1</span>
</code></pre></div><p><code>watch</code>\u4FA6\u6D4B\u4E00\u4E2A\u6216\u591A\u4E2A\u54CD\u5E94\u5F0F\u6570\u636E\u6E90\u5E76\u5728\u6570\u636E\u6E90\u53D8\u5316\u65F6\u8C03\u7528\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u3002</p><blockquote><p>Watches one or more reactive data sources and invokes a callback function when the sources change.</p></blockquote><div class="language-js"><pre><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> prevCount</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="\u601D\u8DEF">\u601D\u8DEF</h3><ol><li>\u7ED9\u51FA\u4E24\u8005\u5B9A\u4E49</li><li>\u7ED9\u51FA\u573A\u666F\u4E0A\u7684\u4E0D\u540C</li><li>\u7ED9\u51FA\u4F7F\u7528\u65B9\u5F0F\u548C\u7EC6\u8282</li><li>\u539F\u7406\u9610\u8FF0</li></ol><h3 id="\u8303\u4F8B">\u8303\u4F8B</h3><ol><li><p><code>watchEffect</code>\u7ACB\u5373\u8FD0\u884C\u4E00\u4E2A\u51FD\u6570\uFF0C\u7136\u540E\u88AB\u52A8\u5730\u8FFD\u8E2A\u5B83\u7684\u4F9D\u8D56\uFF0C\u5F53\u8FD9\u4E9B\u4F9D\u8D56\u6539\u53D8\u65F6\u91CD\u65B0\u6267\u884C\u8BE5\u51FD\u6570\u3002<code>watch</code>\u4FA6\u6D4B\u4E00\u4E2A\u6216\u591A\u4E2A\u54CD\u5E94\u5F0F\u6570\u636E\u6E90\u5E76\u5728\u6570\u636E\u6E90\u53D8\u5316\u65F6\u8C03\u7528\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\u3002</p></li><li><p><code>watchEffect(effect)</code>\u662F\u4E00\u79CD\u7279\u6B8A<code>watch</code>\uFF0C\u4F20\u5165\u7684\u51FD\u6570\u65E2\u662F\u4F9D\u8D56\u6536\u96C6\u7684\u6570\u636E\u6E90\uFF0C\u4E5F\u662F\u56DE\u8C03\u51FD\u6570\u3002\u5982\u679C\u6211\u4EEC\u4E0D\u5173\u5FC3\u54CD\u5E94\u5F0F\u6570\u636E\u53D8\u5316\u524D\u540E\u7684\u503C\uFF0C\u53EA\u662F\u60F3\u62FF\u8FD9\u4E9B\u6570\u636E\u505A\u4E9B\u4E8B\u60C5\uFF0C\u90A3\u4E48<code>watchEffect</code>\u5C31\u662F\u6211\u4EEC\u9700\u8981\u7684\u3002watch\u66F4\u5E95\u5C42\uFF0C\u53EF\u4EE5\u63A5\u6536\u591A\u79CD\u6570\u636E\u6E90\uFF0C\u5305\u62EC\u7528\u4E8E\u4F9D\u8D56\u6536\u96C6\u7684getter\u51FD\u6570\uFF0C\u56E0\u6B64\u5B83\u5B8C\u5168\u53EF\u4EE5\u5B9E\u73B0watchEffect\u7684\u529F\u80FD\uFF0C\u540C\u65F6\u7531\u4E8E\u53EF\u4EE5\u6307\u5B9Agetter\u51FD\u6570\uFF0C\u4F9D\u8D56\u53EF\u4EE5\u63A7\u5236\u7684\u66F4\u7CBE\u786E\uFF0C\u8FD8\u80FD\u83B7\u53D6\u6570\u636E\u53D8\u5316\u524D\u540E\u7684\u503C\uFF0C\u56E0\u6B64\u5982\u679C\u9700\u8981\u8FD9\u4E9B\u65F6\u6211\u4EEC\u4F1A\u4F7F\u7528watch\u3002</p></li><li><p><code>watchEffect</code>\u5728\u4F7F\u7528\u65F6\uFF0C\u4F20\u5165\u7684\u51FD\u6570\u4F1A\u7ACB\u523B\u6267\u884C\u4E00\u6B21\u3002<code>watch</code>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u5E76\u4E0D\u4F1A\u6267\u884C\u56DE\u8C03\u51FD\u6570\uFF0C\u9664\u975E\u6211\u4EEC\u624B\u52A8\u8BBE\u7F6E<code>immediate</code>\u9009\u9879\u3002</p></li><li><p>\u4ECE\u5B9E\u73B0\u4E0A\u6765\u8BF4\uFF0C<code>watchEffect(fn)</code>\u76F8\u5F53\u4E8E<code>watch(fn,fn,{immediate:true})</code></p></li></ol><h3 id="\u77E5\u5176\u6240\u4EE5\u7136">\u77E5\u5176\u6240\u4EE5\u7136</h3><p><code>watchEffect</code>\u5B9A\u4E49\uFF1A<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fcore%2Fblob%2FHEAD%2Fpackages%2Fruntime-core%2Fsrc%2FapiWatch.ts%23L80-L81" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/core/\u2026</a></p><div class="language-ts"><pre><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">watchEffect</span><span class="token punctuation">(</span>
  effect<span class="token operator">:</span> WatchEffect<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> WatchOptionsBase
<span class="token punctuation">)</span><span class="token operator">:</span> WatchStopHandle <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">doWatch</span><span class="token punctuation">(</span>effect<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><hr><p><code>watch</code>\u5B9A\u4E49\u5982\u4E0B\uFF1A<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fcore%2Fblob%2FHEAD%2Fpackages%2Fruntime-core%2Fsrc%2FapiWatch.ts%23L158-L159" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/core/\u2026</a></p><div class="language-ts"><pre><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">watch</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token punctuation">,</span> Immediate <span class="token keyword">extends</span> Readonly<span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  source<span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> WatchSource<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  cb<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> WatchOptions<span class="token operator">&lt;</span>Immediate<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token operator">:</span> WatchStopHandle <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">doWatch</span><span class="token punctuation">(</span>source <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">,</span> cb<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>\u5F88\u660E\u663E<code>watchEffect</code>\u5C31\u662F\u4E00\u79CD\u7279\u6B8A\u7684<code>watch</code>\u5B9E\u73B0\u3002</p><h2 id=""></h2>`,21),p=[o];function c(l,u,r,i,k,d){return s(),a("div",null,p)}var w=n(e,[["render",c]]);export{f as __pageData,w as default};
