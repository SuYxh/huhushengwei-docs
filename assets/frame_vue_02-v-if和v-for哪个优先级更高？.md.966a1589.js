import{o as n,c as s,b as a}from"./app.157864df.js";const t='{"title":"02-v-if和v-for哪个优先级更高？","description":"","frontmatter":{},"headers":[{"level":2,"title":"02-v-if和v-for哪个优先级更高？","slug":"_02-v-if和v-for哪个优先级更高？"},{"level":3,"title":"分析：","slug":"分析："},{"level":3,"title":"思路分析：","slug":"思路分析："},{"level":3,"title":"回答范例：","slug":"回答范例："},{"level":3,"title":"知其所以然：","slug":"知其所以然："}],"relativePath":"frame/vue/02-v-if和v-for哪个优先级更高？.md","lastUpdated":1662433250869}',o={},e=[a('<h2 id="_02-v-if和v-for哪个优先级更高？">02-v-if和v-for哪个优先级更高？</h2><h3 id="分析：">分析：</h3><p>此题考查常识，文档中曾有详细说明<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fstyle-guide%2F%23%E9%81%BF%E5%85%8D-v-if-%E5%92%8C-v-for-%E7%94%A8%E5%9C%A8%E4%B8%80%E8%B5%B7%E5%BF%85%E8%A6%81" target="_blank" rel="noopener noreferrer">v2</a>|<a href="https://link.juejin.cn/?target=https%3A%2F%2Fstaging.vuejs.org%2Fstyle-guide%2Frules-essential.html%23avoid-v-if-with-v-for" target="_blank" rel="noopener noreferrer">v3</a>；也是一个很好的实践题目，项目中经常会遇到，能够看出面试者api熟悉程度和应用能力。</p><hr><h3 id="思路分析：">思路分析：</h3><ol><li>先给出结论</li><li>为什么是这样的，说出细节</li><li>哪些场景可能导致我们这样做，该怎么处理</li><li>总结，拔高</li></ol><hr><h3 id="回答范例：">回答范例：</h3><ol><li>实践中<strong>不应该把v-for和v-if放一起</strong></li><li>在<strong>vue2中</strong>，<strong>v-for的优先级是高于v-if</strong>，把它们放在一起，输出的渲染函数中可以看出会先执行循环再判断条件，哪怕我们只渲染列表中一小部分元素，也得在每次重渲染的时候遍历整个列表，这会比较浪费；另外需要注意的是在<strong>vue3中则完全相反，v-if的优先级高于v-for</strong>，所以v-if执行时，它调用的变量还不存在，就会导致异常</li><li>通常有两种情况下导致我们这样做： <ul><li>为了<strong>过滤列表中的项目</strong> (比如 <code>v-for=&quot;user in users&quot; v-if=&quot;user.isActive&quot;</code>)。此时定义一个计算属性 (比如 <code>activeUsers</code>)，让其返回过滤后的列表即可（比如<code>users.filter(u=&gt;u.isActive)</code>）。</li><li>为了<strong>避免渲染本应该被隐藏的列表</strong> (比如 <code>v-for=&quot;user in users&quot; v-if=&quot;shouldShowUsers&quot;</code>)。此时把 <code>v-if</code> 移动至容器元素上 (比如 <code>ul</code>、<code>ol</code>)或者外面包一层<code>template</code>即可。</li></ul></li><li>文档中明确指出<strong>永远不要把 <code>v-if</code> 和 <code>v-for</code> 同时用在同一个元素上</strong>，显然这是一个重要的注意事项。</li><li>源码里面关于代码生成的部分，能够清晰的看到是先处理v-if还是v-for，顺序上vue2和vue3正好相反，因此产生了一些症状的不同，但是不管怎样都是不能把它们写在一起的。</li></ol><hr><h3 id="知其所以然：">知其所以然：</h3><p>做个测试，<a href="https://link.juejin.cn/?target=.%2Ftest.html" target="_blank" rel="noopener noreferrer">test.html</a> 两者同级时，渲染函数如下：</p><div class="language-js"><pre><code>ƒ <span class="token function">anonymous</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n<span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>attrs<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">_l</span><span class="token punctuation">(</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>isActive<span class="token punctuation">)</span><span class="token operator">?</span><span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>key<span class="token operator">:</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;\\n      &quot;</span><span class="token operator">+</span><span class="token function">_s</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\\n    &quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">_e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><hr><p>做个测试，test-v3.html</p><p><img src="https://qn.huat.xyz/mac/20220828183314.awebp" alt="image-20220210104854185"></p><hr><p>源码中找答案</p><p>v2：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fvue%2Fblob%2FHEAD%2Fsrc%2Fcompiler%2Fcodegen%2Findex.js%23L65-L66" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/vue/b…</a></p><p>v3：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fvuejs%2Fcore%2Fblob%2FHEAD%2Fpackages%2Fcompiler-core%2Fsrc%2Fcodegen.ts%23L586-L587" target="_blank" rel="noopener noreferrer">github1s.com/vuejs/core/…</a></p>',20)];o.render=function(a,t,o,p,c,u){return n(),s("div",null,e)};export default o;export{t as __pageData};
